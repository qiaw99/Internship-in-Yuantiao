<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Vertices For Geometry</title>
    <script src="../build/three.js"></script>
    <script src="./js/libs/stats.js"></script>
    <script src="./js/utils/SceneUtils.js"></script>
    <script src="./js/shaders/CopyShader.js"></script>
	<script src="./js/loaders/GLTFLoader.js"></script>
	<script src="./js/misc/Gyroscope.js"></script>

</head>
<body>
<script id="vertex-Shader" type="x-shader/x-vertex">
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
		}
	</script>

<script id="fragment-Shader" type="x-shader/x-fragment">
		uniform sampler2D texture1;
		uniform sampler2D texture2;
		varying vec2 vUv;

		void main() {
			vec4 temp = texture2D(texture2,vUv);
			if(temp.x <0.1 && temp.y <0.1&&temp.x <0.1){
				gl_FragColor = vec4(1.0,1.0,1.0,0.0);
			} else {
			 	gl_FragColor = mix(temp*2.0, texture2D(texture1,vUv)*2.5, 0.5);
			}
		}
	</script>

<script id="fragment-Shader-tag" type="x-shader/x-fragment">
		uniform sampler2D texture1;
		uniform sampler2D texture2;
		varying vec2 vUv;

		void main() {
			vec4 temp = texture2D(texture2,vUv);
			gl_FragColor = mix(temp*2.0, texture2D(texture1,vUv)*2.5, 0.5);
		}
</script>

<script type="module">
    import { OrbitControls } from './jsm/controls/OrbitControls.js';
    import { GUI } from './jsm/libs/dat.gui.module.js';
    import { EffectComposer } from './jsm/postprocessing/EffectComposer.js';
    import { RenderPass } from './jsm/postprocessing/RenderPass.js';
    
    import { ShaderPass } from './jsm/postprocessing/ShaderPass.js';
    import { UnrealBloomPass } from './jsm/postprocessing/UnrealBloomPass.js';
    import { Line2 } from './jsm/lines/Line2.js';
    import { LineMaterial } from './jsm/lines/LineMaterial.js';
    import { LineGeometry } from './jsm/lines/LineGeometry.js';
    import { LineSegments2 } from './jsm/lines/LineSegments2.js';
    import { GeometryUtils } from './jsm/utils/GeometryUtils.js';
	import { Ocean } from './jsm/misc/Ocean.js';
	import { Water } from './jsm/objects/Water.js';
	import { Water2 } from './jsm/objects/Water2.js';
	import { PMREMGenerator } from './jsm/pmrem/PMREMGenerator.js';



	let mousePosition = new THREE.Vector2();
	mousePosition.x = -1e9;
	mousePosition.y = -1e9;
	let raycaster = new THREE.Raycaster();
	// raycaster.far = 1000000;
	// raycaster.near = 2000;
	let camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 100, 10000);//perspective是透视摄像机，这种摄像机看上去画面有3D效果
	camera.position.set(3500,1500,2000);
	camera.rotation.x = Math.PI;
	camera.rotation.y = -Math.PI/4;
	camera.rotation.z = Math.PI/2;
	camera.lookAt(0, 0, 0);//摄像机对焦的位置
	var INTERSECTED = null;

	let lastCameraPos = new THREE.Vector3(-1,-1,-1);
	let interval = 15;

	export class WaterPlant{

		constructor(modelUrl,widthModel, lengthModel, waterpoolAlert, cl1Tag, cl2Tag, waterpool1Tag, waterpool2Tag, waterplantTag, scaleSize,waterNormalTexture, normal1, normal2, wplantfunc) {
			this.modelUrl = modelUrl;
			this.scaleSize = scaleSize;
			this.previousAllstatus = true;
			this.currentAllStatus = true;
			this.waterNormalTexture = waterNormalTexture;
			this.normal1 = normal1;
			this.normal2 = normal2;
			this.speed = 0.01;
			this.lastSpeed = 0.01;
			this.widthModel =widthModel;
			this.lengthModel =lengthModel;
			this.fences_signal = [];
			this.interval = 15;
			this.itemdis = 100;
			this.return2Ori = false;
			var textureLoader = new THREE.TextureLoader();
			this.waterpoolAlert1Pic = textureLoader.load(waterpoolAlert);
			this.waterpoolAlert2Pic = textureLoader.load(waterpoolAlert);
			this.cl1AlertPic = textureLoader.load(waterpoolAlert);
			this.cl2AlertPic = textureLoader.load(waterpoolAlert);

			this.cl1TagPic =   textureLoader.load(cl1Tag);
			this.cl2TagPic =   textureLoader.load(cl2Tag);
			this.waterpool1TagPic =   textureLoader.load(waterpool1Tag);
			this.waterpool2TagPic =   textureLoader.load(waterpool2Tag);
			this.waterplantTagPic =   textureLoader.load(waterplantTag);

			this.allOffsets = {};

			this.allContents = {};
			this.allProperties = {};
			this.allDeleteLine = {};
			// this.allLinePosition = {};
			this.objects = new Set(); // 空Set

			this.label2value={};
			this.dis = 75;
			this.ddis = 150;

			// this.watch = false;

			this.wplantfunc = wplantfunc;

			this.v1 = new THREE.Vector3();

		}

		setUp(){


			this.renderer = new THREE.WebGLRenderer({
				antialias: true
			});//定义渲染器
			this.renderer.setSize(window.innerWidth, window.innerHeight);//设置渲染的宽度和高度
			this.renderer.setClearColor(0x000000, 1.0);//渲染的颜色设置
			document.body.appendChild(this.renderer.domElement);//将渲染器加在html中的div里面


			// renderer.shadowMapEnabled = true;//开启阴影，默认是关闭的，太影响性能
			// renderer.shadowMapType = THREE.PCFSoftShadowMap;//阴影的一个类型

			//这三个参数共同作用才能决定画面

			this.scene = new THREE.Scene();

			var ambientLight = new THREE.PointLight( 0xcccccc, 10.4 );
			ambientLight.position.set(0,50,50);
			this.scene.add( ambientLight );

			this.ms_Controls = new OrbitControls( camera, this.renderer.domElement );
			// ms_Controls.userPan = false;
			// ms_Controls.userPanSpeed = 0.0;
			this.ms_Controls.minDistance = 2000;
			this.ms_Controls.maxDistance = 5000;
			this.ms_Controls.minPolarAngle = Math.PI/3.5;
			this.ms_Controls.maxPolarAngle = Math.PI/2.6;

			// this.gyro = new THREE.Gyroscope();
			// this.gyro1 = new THREE.Gyroscope();
			// this.gyro2 = new THREE.Gyroscope();
			// this.scene.add(this.gyro);
			// this.scene.add(this.gyro1);
			// this.scene.add(this.gyro2);
			// this.gyro.add(camera);
			// this.gyro1.add(camera);
			// this.gyro2.add(camera);


			this.canvas = [];
			this.canvas_ctx = [];

			for(var i = 0; i < 5; ++i){
				let canvas = document.createElement("canvas");
				canvas.width = 1024;
				canvas.height = 1024;
				this.canvas.push(canvas);
				let ctx = canvas.getContext('2d');

				this.canvas_ctx.push(ctx);
			}
			// this.waterpoolAlert1Canvas = document.createElement("canvas");;
			// this.waterpoolAlert1CanvasCtx = this.waterpoolAlert1Canvas.getContext('2d');

			this.baseComponent = new THREE.Object3D();
			this.baseComponent.scale.set(10,10,10);
			//this.baseComponent.rotateOnAxis(new THREE.Vector3(1,0,0), Math.PI/2);

			this.pipelineWaters = []
			var waterGeometry1 = new THREE.CircleGeometry(30.5, 100);
			var waterGeometry2 = new THREE.CircleGeometry(30.5, 100);
			this.water = new Water(
					waterGeometry1,
					{
						textureWidth: 256,
						textureHeight: 256,
						waterNormals: new THREE.TextureLoader().load( this.waterNormalTexture, function ( texture ) {

							texture.wrapS = texture.wrapT = THREE.RepeatWrapping;

						} ),
						alpha: 1.0,
						sunDirection: new THREE.Vector3(),
						sunColor: 0xffffff,
						waterColor: 0x00bbff,
						distortionScale: 3.7,
						fog: false,
						position:this.position
					}
			);

			//this.water.updateMatrixWorld(camera.matrixWorld);
			this.water2 = new Water(
					waterGeometry2,
					{
						textureWidth: 256,
						textureHeight: 256,
						waterNormals: new THREE.TextureLoader().load( this.waterNormalTexture, function ( texture ) {

							texture.wrapS = texture.wrapT = THREE.RepeatWrapping;

						} ),
						alpha: 1.0,
						sunDirection: new THREE.Vector3(),
						sunColor: 0xffffff,
						waterColor: 0x00bbff,
						distortionScale: 3.7,
						fog: false,
						position:this.position
					}
			);
			this.water.rotation.x = -Math.PI/2;
			this.water2.rotation.x = -Math.PI/2;
			this.water.position.set(-56,10,-85.5);
			this.water2.position.set(58,8,-86);


			var that = this;
			var loader = new THREE.GLTFLoader();
			loader.load(this.modelUrl, function ( gltf ) {
				const root = gltf.scene;
				root.children.forEach(element => {
					if (element.type == "Mesh") {
						element.material.emissive = element.material.color;
						element.material.emissiveMap = element.material.map;
					}
				});
				var res = root.children[0];
				res.rotation.z = Math.PI;
				// res.rotation.y = -Math.PI;
				//res.rotation.y = -Math.PI;
				that.baseComponent.add(res);

			} );
			this.redMaterial =new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide});
			this.blueMaterial = new THREE.MeshBasicMaterial({color:0x276ed4, side:THREE.DoubleSide});
			this.fences = [];
			this.fences_times= [];
			this.fences_blue =[];
			for(var i = 0; i < 4; ++i){
				this.fences_blue.push(true);
				this.fences_signal.push(false);
				this.fences_times.push(0);
				let temp = new THREE.Object3D();
				let model;
				if(i < 2){
					model = this.widthModel;
				} else {
					model = this.lengthModel;
				}
				loader.load(model, function ( gltf ) {
					const root = gltf.scene;
					root.children.forEach(element => {
						if (element.type == "Mesh") {
							element.material = that.blueMaterial;
						}
					});
					var res = root.children[0];
					// res.rotation.y = -Math.PI;
					//res.rotation.y = -Math.PI;
					temp.add(res);
				} );
				this.fences.push(temp);
			}

			// console.log(this.fences);



			var uniforms = this.water.material.uniforms;
			var uniforms1 = this.water2.material.uniforms;
			uniforms.size.value = 0.05;
			uniforms1.size.value = 0.05;
			uniforms.alpha.value = 0.4;
			uniforms1.alpha.value = 0.35;


			var pipelineWaterGeometry1 = new THREE.PlaneBufferGeometry( 5.5, 50 );
			//this.plane = new THREE.Mesh(waterGeometry1, new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide}));
			var textureloader = new THREE.TextureLoader();
			var normal1 = textureloader.load( this.normal1 );
			var normal2 = textureloader.load( this.normal2 );

			var pipelineWaterconfig =  {
				color: 0xffffff,
				scale: 0.1,
				flowDirection: new THREE.Vector2( 0, 1 ),
				textureWidth: 1024,
				textureHeight: 1024,
				flowSpeed:0.03,
				//'textures/water/Water_2_M_Normal.jpg'
				normalMap0:normal1,
				normalMap1:normal2
			};
			this.pipelineWater = new Water2( pipelineWaterGeometry1,pipelineWaterconfig);
			this.pipelineWater.position.x = -0.5;
			this.pipelineWater.position.y = 6;
			this.pipelineWater.position.z = -84.5;

			this.pipelineWater.rotation.z = Math.PI * - 0.5;
			this.pipelineWater.rotation.x = -Math.PI /2;


			var pipelineWaterGeometry4 = new THREE.PlaneBufferGeometry( 5.5, 25 );
			//this.plane = new THREE.Mesh(waterGeometry1, new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide}));
			this.pipelineWater4 = new Water2( pipelineWaterGeometry4, pipelineWaterconfig);
			this.pipelineWater4.position.x = 100;
			this.pipelineWater4.position.y = 6;
			this.pipelineWater4.position.z = -84.5

			this.pipelineWater4.rotation.z = Math.PI * - 0.5;
			this.pipelineWater4.rotation.x = -Math.PI /2;

			var pipelineWaterGeometry2 = new THREE.PlaneBufferGeometry( 4.5, 153 );
			//this.plane = new THREE.Mesh(waterGeometry1, new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide}));
			this.pipelineWater2 = new Water2( pipelineWaterGeometry2, pipelineWaterconfig);
			var pipelineWaterGeometry3 = new THREE.PlaneBufferGeometry( 6.2, 155 );
			this.pipelineWater3 = new Water2( pipelineWaterGeometry3, pipelineWaterconfig);


			this.pipelineWater2.position.x = -62.7;
			this.pipelineWater2.position.y = 6;
			this.pipelineWater2.position.z = 21.8;

			this.pipelineWater3.position.x = -69.8;
			this.pipelineWater3.position.y = 6;
			this.pipelineWater3.position.z = 20;
			// this.pipelineWater.rotation.z = Math.PI * - 0.5;
			this.pipelineWater2.rotation.x =  -Math.PI /2;
			this.pipelineWater3.rotation.x =  -Math.PI /2;



			var pipelineWaterGeometry5 = new THREE.PlaneBufferGeometry( 4.5, 8 );
			//this.plane = new THREE.Mesh(waterGeometry1, new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide}));
			this.pipelineWater5 = new Water2( pipelineWaterGeometry5, pipelineWaterconfig);
			var pipelineWaterGeometry6 = new THREE.PlaneBufferGeometry( 4.5, 8.5 );
			this.pipelineWater6 = new Water2( pipelineWaterGeometry5, pipelineWaterconfig);

			this.pipelineWater5.position.x = 62;
			this.pipelineWater5.position.y = 7;
			this.pipelineWater5.position.z = -120.9;

			this.pipelineWater6.position.x = -59.2;
			this.pipelineWater6.position.y = 7;
			this.pipelineWater6.position.z = -120.4;
			// this.pipelineWater.rotation.z = Math.PI * - 0.5;
			this.pipelineWater5.rotation.x =  -Math.PI /2;
			this.pipelineWater6.rotation.x =  -Math.PI /2;

			// this.plane.rotation.x = Math.PI * - 0.5;
			//this.plane.rotation.z = Math.PI * - 0.5;
			//this.baseComponent.add(this.plane);




			this.pipelineWaters.push(this.pipelineWater);
			this.pipelineWaters.push(this.pipelineWater2);
			this.pipelineWaters.push(this.pipelineWater3);
			this.pipelineWaters.push(this.pipelineWater4);
			this.pipelineWaters.push(this.pipelineWater5);
			this.pipelineWaters.push(this.pipelineWater6);

			for(var i = 0; i < this.pipelineWaters.length; ++i){
				this.baseComponent.add(this.pipelineWaters[i]);
			}

			this.baseComponent.add(this.water2);
			this.baseComponent.add(this.water);
			this.fences[0].position.set(-1.0,20,-224.7);
			this.fences[1].position.set(-1.8,20,-1.5);
			this.fences[2].position.set(-221.8,20,-1.6);
			this.fences[3].position.set(-0.2,20,-2.1);
			for(var i = 0 ; i <this.fences.length; ++i){
				this.baseComponent.add(this.fences[i]);
			}
			this.baseComponent.rotation.y= Math.PI*3/4;




			var geo = new THREE.Geometry();
			geo.vertices = [new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0), new THREE.Vector3(1, 1, 0), new THREE.Vector3(1, 0, 0)];
			geo.faces = [new THREE.Face3(0, 1, 2), new THREE.Face3(0, 2, 3)];
			var faceuv = [new THREE.Vector2(0, 1), new THREE.Vector2(1, 1), new THREE.Vector2(1, 0), new THREE.Vector2(0, 0)];

			geo.faceVertexUvs[0] = [];
			geo.faceVertexUvs[0][0] = [faceuv[0], faceuv[1], faceuv[2]];
			geo.faceVertexUvs[0][1] = [faceuv[0], faceuv[2], faceuv[3]];

			this.alertTextures = [];

			for(var i = 0; i < 5; ++i){
				let alertCanvasTexture = new THREE.CanvasTexture(this.canvas[i]);
				this.alertTextures.push(alertCanvasTexture);
			}

			var waterpoolAlert1MixUniforms = {
				texture1 : {value : this.alertTextures[1]},
				texture2 : {value : this.waterpoolAlert1Pic}
			};

			this.waterpoolAlert1Planematerials = new THREE.ShaderMaterial({
				uniforms : waterpoolAlert1MixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.waterpoolAlert1 = new THREE.Mesh(geo, this.waterpoolAlert1Planematerials);
			this.waterpoolAlert1.geometry.computeVertexNormals();
			this.waterpoolAlert1.geometry.center();
			this.waterpoolAlert1.position.set(69.4,128,-135);
			this.waterpoolAlert1.scale.set(70,110,1);

			this.baseComponent.add(this.waterpoolAlert1);



			var waterpoolAlert2MixUniforms = {
				texture1 : {value : this.alertTextures[2]},
				texture2 : {value : this.waterpoolAlert2Pic}
			};

			this.waterpoolAlert2Planematerials = new THREE.ShaderMaterial({
				uniforms : waterpoolAlert2MixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.waterpoolAlert2 = new THREE.Mesh(geo, this.waterpoolAlert2Planematerials);
			this.waterpoolAlert2.geometry.computeVertexNormals();
			this.waterpoolAlert2.geometry.center();
			this.waterpoolAlert2.position.set(-97.7,128,-135);
			this.waterpoolAlert2.scale.set(70,110,1);
			this.baseComponent.add(this.waterpoolAlert2);

			var Cl1MixUniforms = {
				texture1 : {value : this.alertTextures[0]},
				texture2 : {value : this.cl1AlertPic}
			};

			this.cl1Planematerials = new THREE.ShaderMaterial({
				uniforms : Cl1MixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.cl1Alert = new THREE.Mesh(geo, this.cl1Planematerials);
			this.cl1Alert.geometry.computeVertexNormals();
			this.cl1Alert.geometry.center();
			this.cl1Alert.position.set(-151.7,50,0.7);
			this.cl1Alert.scale.set(70,110,1);
			this.baseComponent.add(this.cl1Alert);


			var Cl2MixUniforms = {
				texture1 : {value : this.alertTextures[3]},
				texture2 : {value : this.cl1AlertPic}
			};

			this.cl2Planematerials = new THREE.ShaderMaterial({
				uniforms : Cl2MixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.cl2Alert = new THREE.Mesh(geo, this.cl2Planematerials);
			this.cl2Alert.geometry.computeVertexNormals();
			this.cl2Alert.geometry.center();
			this.cl2Alert.position.set(157.2, 102, -34.8);
			this.cl2Alert.scale.set(70,110,1);
			this.baseComponent.add(this.cl2Alert);


			var waterplantMixUniforms = {
				texture1 : {value : this.alertTextures[4]},
				texture2 : {value : this.cl1AlertPic}
			};

			this.waterplantPlanematerials = new THREE.ShaderMaterial({
				uniforms : waterplantMixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.waterplantAlert = new THREE.Mesh(geo, this.waterplantPlanematerials);
			this.waterplantAlert.geometry.computeVertexNormals();
			this.waterplantAlert.geometry.center();
			this.waterplantAlert.position.set(120.2, 62, 80);
			this.waterplantAlert.scale.set(40,80,1);
			this.baseComponent.add(this.waterplantAlert);


			// var Cl1TagMixUniforms = {
			// 	texture1 : {value : this.tagAlertTextures[0]},
			// 	texture2 : {value : this.tagAlertNoPic}
			// };
			//
			// this.cl1TagPlanematerials = new THREE.ShaderMaterial({
			// 	uniforms : Cl1TagMixUniforms,
			// 	vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
			// 	fragmentShader: document.getElementById( 'fragment-Shader-tag' ).textContent,
			// 	side: THREE.DoubleSide,
			// 	transparent: true,
			// 	alphaTest:0.1
			// });
			this.cl1TagPlanematerials = new THREE.MeshBasicMaterial({map:this.cl1TagPic, side:THREE.DoubleSide})

			this.cl1TagAlert = new THREE.Mesh(geo, this.cl1TagPlanematerials);
			this.cl1TagAlert.geometry.computeVertexNormals();
			this.cl1TagAlert.geometry.center();
			this.cl1TagAlert.position.set(-62.38,26.78,0.62);
			this.cl1TagAlert.scale.set(10,50,1);
			this.baseComponent.add(this.cl1TagAlert);
			// this.scene.add(this.cl1TagAlert);

			// debugger;

			this.waterpool1TagPlanematerials = new THREE.MeshBasicMaterial({map:this.waterpool1TagPic, side:THREE.DoubleSide})

			this.waterpool1TagAlert = new THREE.Mesh(geo, this.waterpool1TagPlanematerials);
			this.waterpool1TagAlert.geometry.computeVertexNormals();
			this.waterpool1TagAlert.geometry.center();
			this.waterpool1TagAlert.position.set(-62.38,35.6,-87.79);
			this.waterpool1TagAlert.scale.set(10,50,1);
			this.baseComponent.add(this.waterpool1TagAlert);


			this.waterpool2TagPlanematerials = new THREE.MeshBasicMaterial({map:this.waterpool2TagPic, side:THREE.DoubleSide});

			this.waterpool2TagAlert = new THREE.Mesh(geo, this.waterpool2TagPlanematerials);
			this.waterpool2TagAlert.geometry.computeVertexNormals();
			this.waterpool2TagAlert.geometry.center();
			this.waterpool2TagAlert.position.set(43.49,35.6,-78.79);
			this.waterpool2TagAlert.scale.set(10,50,1);
			this.baseComponent.add(this.waterpool2TagAlert);


			this.cl2TagPlanematerials =  new THREE.MeshBasicMaterial({map:this.cl1TagPic, side:THREE.DoubleSide});

			this.cl2TagAlert = new THREE.Mesh(geo, this.cl2TagPlanematerials);
			this.cl2TagAlert.geometry.computeVertexNormals();
			this.cl2TagAlert.geometry.center();
			this.cl2TagAlert.position.set(65.96,40.01,-43.49);
			this.cl2TagAlert.scale.set(10,50,1);
			this.baseComponent.add(this.cl2TagAlert);



			this.waterplantPlanematerials = new THREE.MeshBasicMaterial({map:this.waterplantTagPic, side:THREE.DoubleSide});

			this.waterplantTagAlert = new THREE.Mesh(geo, this.waterplantPlanematerials);
			this.waterplantTagAlert.geometry.computeVertexNormals();
			this.waterplantTagAlert.geometry.center();
			this.waterplantTagAlert.position.set(16.67,22.37,45.74);
			this.waterplantTagAlert.scale.set(15,80,1);
			this.baseComponent.add(this.waterplantTagAlert);


			var cubeMat1 = new THREE.MeshLambertMaterial({//创建材料
				color:0xff0000,
				transparent:true,
				opacity:0.0,
				alphaTest:0.0
			});
			this.wholeDetectObject = new THREE.Object3D();
			var cubeGeo2 = new THREE.CubeGeometry(3000,3000, 3000);//创建立方体
			this.wholeDetectCube = new THREE.Mesh(cubeGeo2, cubeMat1);//创建立方体网格模型
			this.wholeDetectObject.add(this.wholeDetectCube);
			this.wholeDetectObject.rotation.y=-Math.PI/4;
			this.wholeDetectObject.position.set(0,-1480,0);
			this.scene.add(this.wholeDetectObject);


			// this.clickDetectObject = new THREE.Object3D();
			// var cubeGeo3 = new THREE.CubeGeometry(50,50, 50);//创建立方体
			// // var cubeMat2 = new THREE.MeshLambertMaterial({//创建材料
			// // 	color:0xff0000,
			// // 	wireframe:true
			// // });
			// this.clickDetectCube = new THREE.Mesh(cubeGeo3, cubeMat1);//创建立方体网格模型
			// this.clickDetectObject.add(this.clickDetectCube);
			// this.clickDetectObject.rotation.y=-Math.PI/4;
			// this.clickDetectObject.position.set(45.67,-10.37,60.74);
			// this.baseComponent.add(this.clickDetectObject);


			this.scene.add(this.baseComponent);
			this.closeAll();
			// var gui = new GUI();
			// var folder = gui.addFolder( 'Water' );
			// //
			// // // folder.add(this.water.rotation, 'x', 0, 5, 0.1 ).name( 'r' );
			// // folder.add(this.waterpoolAlert1.rotation, 'x', this.waterpoolAlert1.rotation.x-100, this.waterpoolAlert1.rotation+100, 0.01 ).name( 'x' );
			// // folder.add(this.waterpoolAlert1.rotation, 'y', this.waterpoolAlert1.rotation.y-100,this.waterpoolAlert1.rotation+100, 0.01 ).name( 'y' );
			// // folder.add(this.waterpoolAlert1.rotation, 'z', this.waterpoolAlert1.rotation.z-100, this.waterpoolAlert1.rotation+100, 0.01 ).name( 'z' );
			// folder.add(this.cl1Alert.position, 'x', this.cl1Alert.position.x-10000, this.cl1Alert.position.x+10000, 0.01 ).name( 'pipelineWater  x2' );
			// folder.add(this.cl1Alert.position, 'y', this.cl1Alert.position.y-10000, this.cl1Alert.position.y+10000, 0.01 ).name( 'pipelineWater  y2' );
			// folder.add(this.cl1Alert.position, 'z', this.cl1Alert.position.z-10000, this.cl1Alert.position.z+10000, 0.01 ).name( 'pipelineWater  z2' );
			// // folder.add(this.waterplantDetectObject.position, 'x', this.waterplantDetectObject.position.x-10000, this.waterplantDetectObject.position.x+10000, 0.01 ).name( 'pipelineWater  x2' );
			// // folder.add(this.waterplantDetectObject.position, 'y', this.waterplantDetectObject.position.y-10000, this.waterplantDetectObject.position.y+10000, 0.01 ).name( 'pipelineWater  y2' );
			// // folder.add(this.waterplantDetectObject.position, 'z', this.waterplantDetectObject.position.z-10000, this.waterplantDetectObject.position.z+10000, 0.01 ).name( 'pipelineWater  z2' );
			//
			//
			//
			// folder.add(this.waterpoolAlert1.position, 'x', this.waterpoolAlert1.position.x-10000, this.waterpoolAlert1.position.x+10000, 0.01 ).name( 'pipelineWater2  x2' );
			// folder.add(this.waterpoolAlert1.position, 'y', this.waterpoolAlert1.position.y-10000, this.waterpoolAlert1.position.y+10000, 0.01 ).name( 'pipelineWater2  y2' );
			// folder.add(this.waterpoolAlert1.position, 'z', this.waterpoolAlert1.position.z-10000, this.waterpoolAlert1.position.z+10000, 0.01 ).name( 'pipelineWater2  z2' );
			//
			//
			// folder.add(this.waterpoolAlert2.position, 'x', this.waterpoolAlert2.position.x-10000, this.waterpoolAlert2.position.x+10000, 0.01 ).name( 'pipelineWater3  x2' );
			// folder.add(this.waterpoolAlert2.position, 'y', this.waterpoolAlert2.position.y-10000, this.waterpoolAlert2.position.y+10000, 0.01 ).name( 'pipelineWater3  y2' );
			// folder.add(this.waterpoolAlert2.position, 'z', this.waterpoolAlert2.position.z-10000, this.waterpoolAlert2.position.z+10000, 0.01 ).name( 'pipelineWater3  z2' );
			//
			//
			// folder.add(this.cl2Alert.position, 'x', this.cl2Alert.position.x-10000, this.cl2Alert.position.x+10000, 0.01 ).name( 'pipelineWater5  x2' );
			// folder.add(this.cl2Alert.position, 'y', this.cl2Alert.position.y-10000, this.cl2Alert.position.y+10000, 0.01 ).name( 'pipelineWater5  y2' );
			// folder.add(this.cl2Alert.position, 'z', this.cl2Alert.position.z-10000, this.cl2Alert.position.z+10000, 0.01 ).name( 'pipelineWater5  z2' );
			// //
			// // folder.add(this.pipelineWater6.position, 'x', this.pipelineWater6.position.x-10000, this.pipelineWater6.position.x+10000, 0.01 ).name( 'pipelineWater6  x2' );
			// // folder.add(this.pipelineWater6.position, 'y', this.pipelineWater6.position.y-10000, this.pipelineWater6.position.y+10000, 0.01 ).name( 'pipelineWater6  y2' );
			// // folder.add(this.pipelineWater6.position, 'z', this.pipelineWater6.position.z-10000, this.pipelineWater6.position.z+10000, 0.01 ).name( 'pipelineWater6  z2' );
			// // //
			// //
			// //
			// folder.add(this.waterplantTagAlert.position, 'x', this.waterplantTagAlert.position.x-10000, this.waterplantTagAlert.position.x+10000, 0.01 ).name( 'water  x2' );
			// folder.add(this.waterplantTagAlert.position, 'y', this.waterplantTagAlert.position.y-10000, this.waterplantTagAlert.position.y+10000, 0.01 ).name( 'water  y2' );
			// folder.add(this.waterplantTagAlert.position, 'z', this.waterplantTagAlert.position.z-10000, this.waterplantTagAlert.position.z+10000, 0.01 ).name( 'water  z2' );
			//
			// folder.add(this.alertMeshs[1].position, 'x', this.alertMeshs[1].position.x-10000, this.alertMeshs[1].position.x+10000, 0.01 ).name( 'water2  x2' );
			// folder.add(this.alertMeshs[1].position, 'y', this.alertMeshs[1].position.y-10000, this.alertMeshs[1].position.y+10000, 0.01 ).name( 'water2  y2' );
			// folder.add(this.alertMeshs[1].position, 'z', this.alertMeshs[1].position.z-10000, this.alertMeshs[1].position.z+10000, 0.01 ).name( 'water2  z2' );


			// folder.add(this.tagComponents[0].position, 'x', this.tagAlertComponents[0].position.x-400, this.tagAlertComponents[0].position.x+400,0.01 ).name( 'p1' );
			// folder.add(this.tagComponents[0].position, 'y', this.tagAlertComponents[0].position.y-200, this.tagAlertComponents[0].position.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.tagComponents[0].children[0].position, 'z', this.tagAlertComponents[0].position.z-400, this.tagAlertComponents[0].position.z+400, 0.01 ).name( 'p3' );
			//
			// folder.add(this.tagComponents[0].children[0].children[0].position, 'x', this.tagComponents[0].children[0].children[0].position.x-1000, this.tagComponents[0].children[0].children[0].position.x+1000,0.5 ).name( 'p1' );
			// folder.add(this.tagComponents[0].children[0].children[0].position, 'y', this.tagComponents[0].children[0].children[0].position.y-1000, this.tagComponents[0].children[0].children[0].position.y+1000, 0.5 ).name( 'p2' );
			// folder.add(this.tagComponents[0].children[0].children[0].position, 'z', this.tagComponents[0].children[0].children[0].position.z-1000, this.tagComponents[0].children[0].children[0].position.z+1000, 0.5 ).name( 'p3' );
			// folder.add(this.tagAlertComponents[1].rotation, 'x', this.tagAlertComponents[1].rotation.x-400, this.tagAlertComponents[1].rotation.x+400,0.01 ).name( 'p1' );
			// folder.add(this.tagAlertComponents[1].rotation, 'y', this.tagAlertComponents[1].rotation.y-200, this.tagAlertComponents[1].rotation.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.tagAlertComponents[1].rotation, 'z', this.tagAlertComponents[1].rotation.z-400, this.tagAlertComponents[1].rotation.z+400, 0.01 ).name( 'p3' );
			//
			// folder.add(this.tagAlertComponents[2].position, 'x', this.tagAlertComponents[2].position.x-400, this.tagAlertComponents[2].position.x+400,0.01 ).name( 'p1' );
			// folder.add(this.tagAlertComponents[2].position, 'y', this.tagAlertComponents[2].position.y-200, this.tagAlertComponents[2].position.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.tagAlertComponents[2].position, 'z', this.tagAlertComponents[2].position.z-400, this.tagAlertComponents[2].position.z+400, 0.01 ).name( 'p3' );
			//
			// folder.add(this.tagAlertComponents[3].position, 'x', this.tagAlertComponents[3].position.x-400, this.tagAlertComponents[3].position.x+400,0.01 ).name( 'p1' );
			// folder.add(this.tagAlertComponents[3].position, 'y', this.tagAlertComponents[3].position.y-200, this.tagAlertComponents[3].position.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.tagAlertComponents[3].position, 'z', this.tagAlertComponents[3].position.z-400, this.tagAlertComponents[3].position.z+400, 0.01 ).name( 'p3' );
			//
			// folder.add(this.tagAlertComponents[4].position, 'x', this.tagAlertComponents[4].position.x-400, this.tagAlertComponents[4].position.x+400,0.01 ).name( 'p1' );
			// folder.add(this.tagAlertComponents[4].position, 'y', this.tagAlertComponents[4].position.y-200, this.tagAlertComponents[4].position.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.tagAlertComponents[4].position, 'z', this.tagAlertComponents[4].position.z-400, this.tagAlertComponents[4].position.z+400, 0.01 ).name( 'p3' );



			// }
			// folder.add(this.pipelineWater5.position, 'x', this.pipelineWater5.position.x-400, this.pipelineWater5.position.x+400,0.1 ).name( 'x1' );
			// folder.add(this.pipelineWater5.position, 'y', this.pipelineWater5.position.y-20, this.pipelineWater5.position.y+200, 0.5 ).name( 'y2' );
			// folder.add(this.pipelineWater5.position, 'z', this.pipelineWater5.position.z-400, this.pipelineWater5.position.z+400, 0.1 ).name( 'z3' );
			// folder.add(this.pipelineWater6.position, 'x', this.pipelineWater6.position.x-400, this.pipelineWater6.position.x+400,0.1 ).name( 'p1' );
			// folder.add(this.pipelineWater6.position, 'y', this.pipelineWater6.position.y-20, this.pipelineWater6.position.y+200, 0.5 ).name( 'p2' );
			// folder.add(this.pipelineWater6.position, 'z', this.pipelineWater6.position.z-400, this.pipelineWater6.position.z+400, 0.1 ).name( 'p3' );
			// //
			// folder.add(this.pipelineWater4.position, 'x', this.pipelineWater4.position.x-400, this.pipelineWater4.position.x+400,0.1 ).name( 'x3' );
			// folder.add(this.pipelineWater4.position, 'y', this.pipelineWater4.position.y-20, this.pipelineWater4.position.y+200, 0.5 ).name( 'y3' );
			// folder.add(this.pipelineWater4.position, 'z', this.pipelineWater4.position.z-400, this.pipelineWater4.position.z+400, 0.1 ).name( 'z3' );
			// //folder.add(this.pipelineWater.rotation, 'x', this.pipelineWater.rotation.x-20, this.pipelineWater.rotation.x+20, 0.1 ).name( 'r3' );
			// // folder.add( uniforms.distortionScale, 'value', 0, 8, 0.1 ).name( 'distortionScale' );
			// // folder.add( uniforms1.distortionScale, 'value', 0, 8, 0.1 ).name( 'distortionScale' );
			// // folder.add( uniforms.size, 'value', 0.0, 10, 0.01 ).name( 'size' );
			// // folder.add( uniforms1.size, 'value', 0.0, 10, 0.01 ).name( 'size' );
			// // folder.add( uniforms.alpha, 'value', 0.0, 1, .001 ).name( 'alpha' );
			// // folder.add( uniforms1.alpha, 'value', 0.0, 1, .001 ).name( 'alpha' );
			// folder.open();

			return this.baseComponent;
		}
//大小,是否加粗,颜色
		setTitle(object,content, size, isBold, color){

			this.objects.add(object);
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			}
			if(this.allContents[object] == null){
				this.allContents[object] = [];
			}
			this.allContents[object].push(content);

			if(this.allProperties[object] == null){
				this.allProperties[object] = {};
			}

			var pro = [];
			pro.push(size*150);//大小
			pro.push(isBold);//是否加粗
			pro.push(color);//颜色
			this.allProperties[object][content] = pro;
		}

		setTitlePosition(object, offsetx, offsety){
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			} else {
				this.allOffsets[object][0] = offsetx*50;
				this.allOffsets[object][1] = offsety*50;
			}

		}

		deleteTitle(object){
			this.allDeleteLine[object][0] = true;
		}

		deleteWaterpoolAlert1Line(object, num){
			var cnt = 0;
			for(var i = 1; i < this.allContents[object].length-1; i+=2){
				let flag = true;
				if(this.allDeleteLine[object][i] == true){
					flag = false;
				}
				if(flag){
					cnt++;
					if(cnt == num){
						//console.log(i);
						this.allContents[object][i] = true;
						break;
					}
				}
			}
		}

		setDisBetwLabelValue(dis){
			this.dis = dis;
		}

		setDisBetwLabelLabel(ddis){
			this.ddis = ddis;
		}
		setDisBetwItemItem(ddis){
			this.itemdis = ddis;
		}
		renderContent(){
			for (var object of this.objects) { // 遍历Set
				var index = parseInt(object);
				this.canvas_ctx[index].fillStyle = 'rgba(0,0,0,0)';
				this.canvas[index].style = "border:none";
				// this.c2.lineWidth = 0.0;
				this.canvas_ctx[index].fillRect(0, 0, this.canvas[index].width, this.canvas[index].height); //c.beginPath();
				var offsetx = 0;
				var offsety = 0;
				//debugger;
				var cnt = 0;
				for(var i = 0; i < this.allContents[object].length-1;){
					if(this.allDeleteLine[object]&&this.allDeleteLine[object][i]){
						if(i == 0){
							i++;
						} else {
							i+=2;
						}
						continue;
					}
					var boldSize = "";
					if(this.allProperties[object][this.allContents[object][i]][1]){
						boldSize += "bold ";
					} else {
						boldSize += "normal ";
					}
					boldSize += this.allProperties[object][this.allContents[object][i]][0];
					boldSize += "px ";
					boldSize += "微软雅黑";

					this.canvas_ctx[index].font = boldSize;//粗细/大小/字体
					this.canvas_ctx[index].textAlign = "left";
					this.canvas_ctx[index].textBaseline = "middle";
					this.canvas_ctx[index].fillStyle = this.allProperties[object][this.allContents[object][i]][2];//颜色


					if( i == 0){
						this.canvas_ctx[index].fillText(this.allContents[object][i], this.allOffsets[object][0] , this.allOffsets[object][1]);
						i++;
						offsety+=this.ddis;
					} else {
						this.canvas_ctx[index].fillText(this.allContents[object][i], this.allOffsets[object][0]+offsetx , this.allOffsets[object][1]+offsety);

						boldSize = "";
						if(this.allProperties[object][this.allContents[object][i]][1]){
							boldSize += "bold ";
						} else {
							boldSize += "normal ";
						}
						boldSize += this.allProperties[object][this.allContents[object][i]][0];
						boldSize += "px ";
						boldSize += "Arial";

						this.canvas_ctx[index].font = boldSize;//  粗细/ 大小/ 字体
						this.canvas_ctx[index].textAlign = "left";
						this.canvas_ctx[index].textBaseline = "middle";
						this.canvas_ctx[index].fillStyle = this.allProperties[object][this.label2value[object][this.allContents[object][i]]][2];//颜色

						this.canvas_ctx[index].fillText(this.label2value[object][this.allContents[object][i]], this.allOffsets[object][0]+this.dis+ offsetx, this.allOffsets[object][1]+offsety);
						cnt=cnt+1;
						if(cnt%2==0&&cnt!=0){
							offsety += this.ddis;
							offsetx -= this.itemdis;
						} else {
							offsetx += this.itemdis;
						}
						i+=2;
					}

				}
			}
		}

		setLine(object, label, lsize, lisBold, lcolor, value, vsize, visBold, vcolor){
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			}
			if(this.allContents[object] == null){
				this.allContents[object] = [];
			}
			if(this.label2value[object] == null){
				this.label2value[object] = {};
			}
			this.label2value[object][label] = value;

			this.allContents[object].push(label);

			if(this.allProperties[object] == null){
				this.allProperties[object] = {};
			}
			var pro = [];
			pro.push(lsize*150);
			pro.push(lisBold);
			pro.push(lcolor);
			this.allProperties[object][label] = pro;


			this.allContents[object].push(value);
			pro = [];
			pro.push(vsize*150);
			pro.push(visBold);
			pro.push(vcolor);
			this.allProperties[object][value] = pro;
		}
		changeLine(object, label, value, vsize, visBold, vcolor) {
			var pre =  this.label2value[object][label];
			this.label2value[object][label] = value;
			if(vsize!=null&&visBold!=null&&vcolor!=null){
				var pro = [];
				pro.push(vsize*150);
				pro.push(visBold);
				pro.push(vcolor);
				this.allProperties[object][value] = pro;
			} else {
				this.allProperties[object][value] = this.allProperties[object][pre];
			}

		}

		setPosition(position){
			this.position = position;
			this.baseComponent.position.set(this.position.x, this.position.y, this.position.z);
		}

		setScaleSize(scaleSize){
			this.scaleSize = scaleSize;
			this.baseComponent.scale.set(this.scaleSize , this.scaleSize , this.scaleSize );
		}
		setSpeed(speed){
			this.speed = speed;
			//this.lastSpeed = this.speed;
		}

		turnOnFence(index){
			this.fences_signal[index-1]=true;
		}
		turnoffFence(index){
			this.fences_signal[index-1]=false;
		}

		closeAll(){
			this.baseComponent.remove(this.waterpoolAlert1);
			this.baseComponent.remove(this.waterpoolAlert2);
			this.baseComponent.remove(this.cl1Alert);
			this.baseComponent.remove(this.cl2Alert);
			this.baseComponent.remove(this.waterplantAlert);

			this.baseComponent.remove(this.waterpool1TagAlert);
			this.baseComponent.remove(this.waterpool2TagAlert);
			this.baseComponent.remove(this.cl1TagAlert);
			this.baseComponent.remove(this.cl2TagAlert);
			this.baseComponent.remove(this.waterplantTagAlert);
		}
		showAll(){
			this.baseComponent.add(this.waterpoolAlert1);
			this.baseComponent.add(this.waterpoolAlert2);
			this.baseComponent.add(this.cl1Alert);
			this.baseComponent.add(this.cl2Alert);
			this.baseComponent.add(this.waterplantAlert);

			this.baseComponent.add(this.waterpool1TagAlert);
			this.baseComponent.add(this.waterpool2TagAlert);
			this.baseComponent.add(this.cl1TagAlert);
			this.baseComponent.add(this.cl2TagAlert);
			this.baseComponent.add(this.waterplantTagAlert);

		}

		animate(){
			// this.ms_Controls.update();

			if(this.baseComponent){

				if(this.speed==0.0 && lastCameraPos.x == camera.position.x && lastCameraPos.y == camera.position.y && lastCameraPos.z == camera.position.z){
					interval--;
					if(interval == 0){
						this.showAll();
					}
				} else {
					interval = 15;
					lastCameraPos.x = camera.position.x;
					lastCameraPos.y = camera.position.y;
					lastCameraPos.z = camera.position.z;
					this.closeAll();
				}

				//
				// for(var i = 0; i < this.baseComponents.length; ++i){
				// 	this.baseComponents[i].position.copy(camera.position);
				// 	this.baseComponents[i].rotation.copy(camera.rotation);
				// 	this.baseComponents[i].updateMatrix();
				// }
				this.renderer.render(this.scene, camera);
				// camera.updateMatrixWorld();
				camera.getWorldPosition(this.v1)

				this.waterpoolAlert1.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterpoolAlert1.rotation.z+=Math.PI*3/2;
				// console.log(this.waterpoolAlert1.rotation.z);

				this.waterpoolAlert2.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterpoolAlert2.rotation.z+=Math.PI*3/2;


				this.waterplantAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterplantAlert.rotation.z+=Math.PI*3/2;


				this.cl1Alert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.cl1Alert.rotation.z+=Math.PI*3/2;

				this.cl2Alert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.cl2Alert.rotation.z+=Math.PI*3/2;

				this.cl1TagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.cl1TagAlert.rotation.z+=Math.PI*3/2;

				this.cl2TagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.cl2TagAlert.rotation.z+=Math.PI*3/2;

				this.waterpool1TagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterpool1TagAlert.rotation.z+=Math.PI*3/2;

				this.waterpool2TagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterpool2TagAlert.rotation.z+=Math.PI*3/2;

				this.waterplantTagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.waterplantTagAlert.rotation.z+=Math.PI*3/2;
				//
				// this.waterpoolAlert2.lookAt(this.v1.x,this.v1.x, this.v1.z);
				// this.waterpoolAlert2.rotation.z+=Math.PI*3/2;
				// console.log(this.waterpoolAlert2.rotation.z);
				// this.alertMeshs[1].lookAt(camera.getWorldPosition(this.v1))
				// for(var i = 0; i < this.temp.children.length; ++i){
				// 	//
				// 	// this.baseComponents[i].children[0].geometry.verticesNeedUpdate = true;
				// 	//this.waterpoolAlert1.lookAt(camera.getWorldPosition(this.v1));
				// 	this.temp.children[i].lookAt(camera.getWorldPosition(this.v1));
				// }
				// this.renderer.render(this.scene, camera);
				// this.cl1TagPic.needsUpdate = true;
				this.renderContent();
				for(var i = 0; i < this.alertTextures.length; ++i){
					this.alertTextures[i].needsUpdate = true;
				}

			//
				for(var i = 0; i < this.fences_signal.length; ++i){
					if(this.fences_signal[i]){
						if(++this.fences_times[i] == this.interval){
							this.fences_times[i]=0;
							if(!this.fences_blue[i]) {
								this.fences[i].children[0].material = this.blueMaterial;
								this.fences_blue[i] = true;
							} else {
								this.fences[i].children[0].material = this.redMaterial;
								this.fences_blue[i] = false;
							}
						}

					}
				}


				// console.log(this.baseComponent.rotation.y);
				// if(this.return2Ori){
				// 	if(this.direct == -1){
				// 		if(this.baseComponent.rotation.y>=this.target){
				// 			this.baseComponent.rotation.y-=this.speed;
				// 		}
				// 		if(this.baseComponent.rotation.y <= this.target){
				// 			this.baseComponent.rotation.y=this.target;
				// 			this.return2Ori = false;
				// 			this.setSpeed(0.0);
				// 			this.showAll();
				// 		}
				// 	} else {
				// 		if(this.baseComponent.rotation.y<=this.target){
				// 			this.baseComponent.rotation.y+=this.speed;
				// 		}
				// 		if(this.baseComponent.rotation.y >= this.target){
				// 			this.baseComponent.rotation.y=this.target;
				// 			this.return2Ori = false;
				// 			this.setSpeed(0.0);
				// 			this.showAll();
				// 		}
				// 	}
				// } else {

					// console.log(mousePosition.x, mousePosition.y);
					// if(mousePosition.x == 0 &&mousePosition.y == 0){
					// 	console.log("sadddddd");
					// }

					// console.log(mousePosition)

						raycaster.setFromCamera( mousePosition, camera );

						//this.waterplantDetectObject.children[0]
						var intersects = raycaster.intersectObjects( [this.waterplantTagAlert, this.wholeDetectObject.children[0]] );
						// if ( intersects.length > 0 ) {
						// 	if ( INTERSECTED != intersects[ 0 ].object ) {
						//
						// 		if ( INTERSECTED ) {
						// 			console.log("sadasdsafs");
						// 		}
						//
						// 		INTERSECTED = intersects[ 0 ].object;
						//
						// 	}
						//
						// } else {
						//
						// 	INTERSECTED = null;
						//
						// }


					// console.log(intersects.length);

					if ( intersects.length == 1 ) {
						if(this.speed!=0.0){
							this.lastSpeed = this.speed;
							this.setSpeed(0.0);
							this.showAll();
							// // debugger;
							// if (this.baseComponent.rotation.y*1e15-(Math.PI*3/4)*1e15!=0) {
							// 	// debugger;
							// 	var round = Math.floor((this.baseComponent.rotation.y-(Math.PI*3/4))/(2*Math.PI) );
							// 	if(Math.abs(this.baseComponent.rotation.y - (Math.PI*3/4 + round * 2*Math.PI)) >
							// 			Math.abs(this.baseComponent.rotation.y - (Math.PI*3/4 + (round+1) * 2*Math.PI))){
							// 		this.target = Math.PI*3/4 + (round+1) * 2*Math.PI;
							// 		this.direct = 1;
							// 	} else {
							// 		this.target = Math.PI*3/4 + (round) * 2*Math.PI;
							// 		this.direct = -1;
							// 	}
							// }
							//
							// this.return2Ori = true;
						} else {
							this.setSpeed(this.lastSpeed);
							this.closeAll();
						}
					} else if(intersects.length == 2 ){
						if(this.speed!=0.0){
							this.lastSpeed = this.speed;
							this.setSpeed(0.0);
							this.showAll();
						}
						this.wplantfunc();
					}
					mousePosition.x = -1e9;
					mousePosition.y = -1e9;
					// if(click_pos && Math.abs(click_pos.coordinate.x-this.ori_position.x) <= 5.0&&Math.abs(click_pos.coordinate.y-this.ori_position.y) <= 5.0  ) {
					// 	if(Math.pow(Math.abs(click_pos.coordinate.x-this.cl1pos.x), 2)+ Math.pow(Math.abs(click_pos.coordinate.y-this.cl1pos.y), 2) <= 0.5){
					// 		this.cl1func();
					// 	} else if(Math.pow(Math.abs(click_pos.coordinate.x-this.wp1pos.x), 2)+ Math.pow(Math.abs(click_pos.coordinate.y-this.wp1pos.y), 2) <= 0.5){
					// 		this.wp1func();
					// 	} else if(Math.pow(Math.abs(click_pos.coordinate.x-this.wp2pos.x), 2)+ Math.pow(Math.abs(click_pos.coordinate.y-this.wp2pos.y), 2) <= 0.5){
					// 		this.wp2func();
					// 	} else if(Math.pow(Math.abs(click_pos.coordinate.x-this.cl2pos.x), 2)+ Math.pow(Math.abs(click_pos.coordinate.y-this.cl2pos.y), 2) <= 0.5){
					// 		this.cl2func();
					// 	} else if(Math.pow(Math.abs(click_pos.coordinate.x-this.wplantpos.x), 2)+ Math.pow(Math.abs(click_pos.coordinate.y-this.wplantpos.y), 2) <= 0.5){
					//
					// 	} else {
					// 		if(this.speed!=0.0){
					// 			this.lastSpeed = this.speed;
					// 			this.setSpeed(0.02);
					//
					// 			if (this.baseComponent.rotation.y != 0) {
					// 				var round = Math.floor(this.baseComponent.rotation.y / (2*Math.PI*3/4));
					// 				if (round % 2 == 0) {
					// 					this.target = (round+1)*Math.PI*3/4;
					// 					this.direct = -1;
					// 				} else {
					// 					this.target = (round + 2) * Math.PI*3/4;
					// 					this.direct = 1;
					// 				}
					// 			}
					//
					// 			this.return2Ori = true;
					// 		} else {
					// 			this.closeAll();//关闭所有
					// 			this.setSpeed(this.lastSpeed);
					// 		}
					// 	}
					// 	click_pos.coordinate.x = -1;
					// 	click_pos.coordinate.y = -1;
					// }



					this.baseComponent.rotation.y+=this.speed;
				// }

			// 	// if(this.water.rotation.y <= 10.0){
			// 	//     this.water.rotation.y+=0.5;
			// 	// }
			// 	// if(this.water2.rotation.y <= 10.0){
			// 	//     this.water2.rotation.y+=0.5;
			// 	// }
			// 	// if(this.water2.material.uniforms.alpha.value <= 0.45){
			// 	//     this.water2.material.uniforms.alpha.value+=0.02;
			// 	// }
			// 	//this.updateSun();
			// 	//this.plane.position.set(this.pipelineWater.position.x,this.pipelineWater.position.y-3,this.pipelineWater.position.z);
			// 	// if( this.pipelineWater.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater.rotation.x += Math.PI*0.025;
			// 	// }
			// 	// if( this.pipelineWater2.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater2.rotation.x += Math.PI*0.025;
			// 	// }
			// 	// if( this.pipelineWater3.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater3.rotation.x += Math.PI*0.025;
			// 	// }
			// 	//
			// 	// if( this.pipelineWater4.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater4.rotation.x += Math.PI*0.025;
			// 	// }
			// 	//
			// 	// if( Math.abs(this.pipelineWater4.position.x) < 100){
			// 	// 	this.pipelineWater4.position.x -= 10;
			// 	// }
			// 	// if( Math.abs(this.pipelineWater4.position.z) < 84.5){
			// 	// 	this.pipelineWater4.position.z -= 6.5;
			// 	// }
			// 	//
			// 	// if( this.pipelineWater5.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater5.rotation.x += Math.PI*0.025;
			// 	// }
			// 	// if( this.pipelineWater6.rotation.x < Math.PI*4.5){
			// 	// 	this.pipelineWater6.rotation.x += Math.PI*0.025;
			// 	// }
			//
				this.water.geometry.verticesNeedUpdate = true;
				this.water2.geometry.verticesNeedUpdate = true;
			// 	// this.water.geometry.elementsNeedUpdate = true;
			// 	// this.water.geometry.groupsNeedUpdate = true;
			// 	// this.water.material.needsUpdate = true;
			// 	// this.water2.material.needsUpdate = true;
			// 	//console.log(this.pipelineWater.rotation.x,this.pipelineWater.rotation.y,this.pipelineWater.rotation.z);
				this.water.material.uniforms[ 'time' ].value += 1.0 / 60.0;
				this.water2.material.uniforms[ 'time' ].value += 1.0 / 60.0;
			// 	//console.log(this.baseComponent);
			// 	if(this.previousAllstatus != this.currentAllStatus) {
			// 		if(this.currentAllStatus){
			// 			this.scene.add(this.baseComponent);
			// 		} else {
			// 			this.scene.remove(this.baseComponent);
			// 		}
			// 	}
			//
			}
		}

		turnONOFF(status){
			this.previousAllstatus = this.currentAllStatus;
			this.currentAllStatus = status;
		}

		setWaterMark1(watermark){
			for(var i  = 0; i < this.water.geometry.vertices.length; ++i){
				this.water.geometry.vertices[i].z+=watermark;
			}
		}
		setWaterMark2(watermark){
			for(var i  = 0; i < this.water2.geometry.vertices.length; ++i){
				this.water2.geometry.vertices[i].z+=watermark;
			}
		}
		closePipeLineWater(index){
			this.baseComponent.remove(this.pipelineWaters[index-1]);
		}
		addPipeLineWater(index){
			this.baseComponent.add(this.pipelineWaters[index-1]);
		}
		destroy() {
			if (this.baseComponent) {
				for(var i = 0; i < this.pipelineWaters.length; ++i){
					this.pipelineWaters[i].material.dispose();
					this.pipelineWaters[i].geometry.dispose();
					this.pipelineWaters[i] = null;
				}
				if(this.baseComponent.geometry)
					this.baseComponent.geometry.dispose();
				if(this.baseComponent.material)
					this.baseComponent.material.dispose();
				this.scene.remove(this.baseComponent);
				this.baseComponent = null;
			}
		}
	}

	function onDocumentMouseMove( event ) {

		event.preventDefault();
		mousePosition.x = ( event.clientX / window.innerWidth ) * 2 - 1;
		mousePosition.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
		//console.log(this.mousePosition.x , this.mousePosition.y);
	}
	/* 窗口变动触发 */
	function onWindowResize() {

		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		//renderer.setSize(window.innerWidth, window.innerHeight);

	}
	window.addEventListener( 'dblclick', onDocumentMouseMove, false );
	window.addEventListener('resize', onWindowResize, false);

	var waterplant = new WaterPlant("./55.gltf","./d_zl_2.gltf","./c_zl_2.gltf","./bg_tc11.png","./jlj.png","./jlj.png","./qsc1.png","./qsc2.png","./sc.png" ,10,"./waternormals.jpg","./Water_1_M_Normal.jpg","./Water_2_M_Normal.jpg",
			function(){console.log("wplant");});
	waterplant.setUp();
	function animate(){
		requestAnimationFrame(animate);
		waterplant.animate();
	}
	animate();

	waterplant.setTitle("0","123",0.25,true,"red");
	waterplant.setLine("0","12sd3",0.25,true,"red","3545",0.25,true,"red");
	waterplant.setLine("0","453464",0.25,true,"red","1111",0.25,true,"red");

	waterplant.setTitle("1","123",0.25,true,"red");
	waterplant.setLine("1","12sd3",0.25,true,"red","3545",0.25,true,"red");
	waterplant.setLine("1","453464",0.25,true,"red","1111",0.25,true,"red");
	//
	waterplant.setTitle("2","123",0.25,true,"red");
	waterplant.setLine("2","12sd3",0.25,true,"red","3545",0.25,true,"red");
	waterplant.setLine("2","453464",0.25,true,"red","1111",0.25,true,"red");


	waterplant.setTitle("3","123",0.25,true,"red");
	waterplant.setLine("3","12sd3",0.25,true,"red","3545",0.25,true,"red");
	waterplant.setLine("3","453464",0.25,true,"red","1111",0.25,true,"red");

	// waterplant.changeLine("0","12sd3", "ssssssssssss",0.25,null,"white");
	waterplant.turnOnFence(1);
	waterplant.turnOnFence(2);
	waterplant.setDisBetwLabelLabel(150);
	waterplant.setDisBetwLabelValue(200);
	waterplant.setDisBetwItemItem(400);
	waterplant.setTitlePosition("0",5,5);
	waterplant.changeLine("0","453464","sadasdasd",0.25,false,"green");
	// waterplant.setTitlePosition("1", 3,3);
	// waterplant.closePipeLineWater(1);




	// ----------------------------------------------------------------------------
	// var gsize = 130;
	// var res = 1024;
	// var gres = res / 2;
	// var origx = - gsize / 2;
	// var origz = - gsize / 2;
	// var ms_Ocean = new Ocean( renderer, camera, scene,
	// 						{
	// 							USE_HALF_FLOAT: false,
	// 							INITIAL_SIZE: 1200.0,
	// 							INITIAL_WIND: [ 10.0, 10.0 ],
	// 							INITIAL_CHOPPINESS: 2.0,
	// 							CLEAR_COLOR: [ 1.0, 1.0, 1.0, 0.0 ],
	// 							GEOMETRY_ORIGIN: [ 10000, 10000 ],
	// 							SUN_DIRECTION: [ - 1.0, 1.0, 1.0 ],
	// 							OCEAN_COLOR: new THREE.Vector3( 0.804, 0.616, 0.747 ),// 0.104, 0.016, 0.047
	// 							SKY_COLOR: new THREE.Vector3( 3.2, 9.6, 12.8 ),
	// 							EXPOSURE: 0.35,
	// 							GEOMETRY_RESOLUTION: gres,
	// 							GEOMETRY_SIZE: gsize,
	// 							RESOLUTION: res
	// 						} );
	//
	// ms_Ocean.materialOcean.uniforms[ "u_projectionMatrix" ] = { value: camera.projectionMatrix };
	// ms_Ocean.materialOcean.uniforms[ "u_viewMatrix" ] = { value: camera.matrixWorldInverse };
	// ms_Ocean.materialOcean.uniforms[ "u_cameraPosition" ] = { value: camera.position };
	// var sun = new THREE.Vector3();
	//
	// // Water
	//
	// var waterGeometry1 = new THREE.CircleGeometry(31, 80);
	// var waterGeometry2 = new THREE.CircleGeometry(30, 80);
	// var water = new Water(
	// 		waterGeometry1,
	// 		{
	// 			textureWidth: 256,
	// 			textureHeight: 256,
	// 			waterNormals: new THREE.TextureLoader().load( 'textures/waternormals.jpg', function ( texture ) {
	//
	// 				texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
	//
	// 			} ),
	// 			alpha: 1.0,
	// 			sunDirection: new THREE.Vector3(),
	// 			sunColor: 0xffffff,
	// 			waterColor: 0x00ccff,
	// 			distortionScale: 3.7,
	// 			fog: false
	// 		}
	// );
	//
	// var water2 = new Water(
	// 		waterGeometry2,
	// 		{
	// 			textureWidth: 256,
	// 			textureHeight: 256,
	// 			waterNormals: new THREE.TextureLoader().load( 'textures/waternormals.jpg', function ( texture ) {
	//
	// 				texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
	//
	// 			} ),
	// 			alpha: 1.0,
	// 			sunDirection: new THREE.Vector3(),
	// 			sunColor: 0xffffff,
	// 			waterColor: 0x00ccff,
	// 			distortionScale: 3.7,
	// 			fog: false
	// 		}
	// );
	//
	// water.rotation.x = - Math.PI / 2;
	// water.position.x = 55;
	// water.position.y = 10;
	// water.position.z = 87;
	//
	// water2.rotation.x = - Math.PI / 2;
	// water2.position.x = -56;
	// water2.position.y = 10;
	// water2.position.z = 85;
	// //scene.add( water );
	//
	// // scene.add(baseComponent1);
	//
	//
	// var loader = new THREE.GLTFLoader();
	// var baseComponent = new THREE.Object3D();
	// //console.log(scene);
	// loader.load('http://localhost:23333/video/4.gltf', function ( gltf ) {
	// 	//var coneMesh;
	// 	//coneMesh = new THREE.Mesh( gltf.scene.children[ 0 ].geometry, gltfmaterial );
	// 	// //coneMesh.position = this.position;
	// 	// //coneMesh.scale.setScalar( 100 );
	// 	// console.log(coneMesh);
	// 	// gltf.scene.translateY(1000);
	// 	// scene.add(gltf.scene);
	// 	//scene.add(coneMesh);
	//
	// 	const root = gltf.scene;
	// 	//console.log(root);
	// 	// root.children[0].material = new THREE.MeshBasicMaterial({color:0xff0000});
	// 	root.children.forEach(element => {
	// 		if (element.type == "Mesh") {
	//
	// 			element.parent = scene;
	// 			element.material.emissive = element.material.color;
	// 			element.material.emissiveMap = element.material.map;
	// 			//element.material.transparent = true;
	// 			//element.material.opacity = 0.6;
	// 			//console.log(element);
	// 		}
	// 	});
	// 	//root.children[0].parent  = scene;
	// 	// // });
	// 	//console.log(root);
	// 	var res = root.children[0];
	// 	baseComponent.add(res);
	// 	//scene.add(baseComponent);
	// } );
	// baseComponent.position.set(0,10,0);
	// baseComponent.scale.set(10,10,10);
	// baseComponent.add(water2);
	// baseComponent.add(water);
	//
	// scene.add(baseComponent);
	// var gui = new GUI();
	// // gui.add( ms_Ocean, "size", 100, 5000 ).onChange( function ( v ) {
	// //
	// // 	this.object.size = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "choppiness", 0.1, 4 ).onChange( function ( v ) {
	// //
	// // 	this.object.choppiness = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "windX", - 15, 15 ).onChange( function ( v ) {
	// //
	// // 	this.object.windX = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "windY", - 15, 15 ).onChange( function ( v ) {
	// //
	// // 	this.object.windY = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "sunDirectionX", - 3.0, 3.0 ).onChange( function ( v ) {
	// //
	// // 	this.object.sunDirectionX = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "sunDirectionY", - 3.0, 3.0 ).onChange( function ( v ) {
	// //
	// // 	this.object.sunDirectionY = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "sunDirectionZ", - 3.0, 3.0 ).onChange( function ( v ) {
	// //
	// // 	this.object.sunDirectionZ = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	// //
	// // gui.add( ms_Ocean, "exposure", 0.0, 1.0 ).onChange( function ( v ) {
	// //
	// // 	this.object.exposure = v;
	// // 	this.object.changed = true;
	// //
	// // } );
	//
	//
	// // var pmremGenerator = new THREE.PMREMGenerator( renderer );
	// //
	// // function updateSun() {
	// //
	// // 	var theta = Math.PI * ( parameters.inclination - 0.5 );
	// // 	var phi = 2 * Math.PI * ( parameters.azimuth - 0.5 );
	// //
	// // 	sun.x = Math.cos( phi );
	// // 	sun.y = Math.sin( phi ) * Math.sin( theta );
	// // 	sun.z = Math.sin( phi ) * Math.cos( theta );
	// //
	// // 	sky.material.uniforms[ 'sunPosition' ].value.copy( sun );
	// // 	water.material.uniforms[ 'sunDirection' ].value.copy( sun ).normalize();
	// //
	// // 	scene.environment = pmremGenerator.fromScene( sky ).texture;
	// //
	// // }
	//
	// //updateSun();
	//
	//
	// // var folder = gui.addFolder( 'Water' );
	// // folder.add( uniforms.distortionScale, 'value', 0, 8, 0.1 ).name( 'distortionScale' );
	// // folder.add( uniforms.size, 'value', 0.1, 10, 0.1 ).name( 'size' );
	// // folder.add( uniforms.alpha, 'value', 0.9, 1, .001 ).name( 'alpha' );
	// // folder.open();
	//
	// var waterGeometry1 = new THREE.PlaneBufferGeometry( 5, 50 );
	//
	// var pipelineWater = new Water2( waterGeometry1, {
	// 	color: 0x999999,
	// 	scale: 0.1,
	// 	flowDirection: new THREE.Vector2( 0, 1 ),
	// 	textureWidth: 1024,
	// 	textureHeight: 1024,
	// 	flowSpeed:0.1
	// } );
	// pipelineWater.position.x = 0;
	// pipelineWater.position.y = 6;
	// pipelineWater.position.z = 83.7;
	// pipelineWater.rotation.x = Math.PI * - 0.5;
	// pipelineWater.rotation.z = Math.PI * - 0.5;
	// baseComponent.add(pipelineWater);
	// //scene.add( pipelineWater );
	//
	// var parameters = {
	// 	inclination: 0.49,
	// 	azimuth: 0.205
	// };
	// var pmremGenerator = new PMREMGenerator( renderer );
	//
	// // function updateSun() {
	// //
	// // 	var theta = Math.PI * ( parameters.inclination - 0.5 );
	// // 	var phi = 2 * Math.PI * ( parameters.azimuth - 0.5 );
	// //
	// // 	sun.x = Math.cos( phi );
	// // 	sun.y = Math.sin( phi ) * Math.sin( theta );
	// // 	sun.z = Math.sin( phi ) * Math.cos( theta );
	// //
	// // 	water.material.uniforms[ 'sunDirection' ].value.copy( sun ).normalize();
	// // 	water2.material.uniforms[ 'sunDirection' ].value.copy( sun ).normalize();
	// // }
	// //
	// // updateSun();
	//
	// //var gui = new GUI();
	//
	// // var folder = gui.addFolder( 'Sky' );
	// // folder.add( parameters, 'inclination', 0, 0.5, 0.0001 ).onChange( updateSun );
	// // folder.add( parameters, 'azimuth', 0, 1, 0.0001 ).onChange( updateSun );
	// // folder.open();
	//
	// var uniforms = water.material.uniforms;
	// var uniforms1 = water2.material.uniforms;
	//
	// var folder = gui.addFolder( 'Water' );
	// folder.add( uniforms.distortionScale, 'value', 0, 8, 0.1 ).name( 'distortionScale' );
	// folder.add( uniforms1.distortionScale, 'value', 0, 8, 0.1 ).name( 'distortionScale' );
	// folder.add( uniforms.size, 'value', 0.0, 10, 0.01 ).name( 'size' );
	// folder.add( uniforms1.size, 'value', 0.0, 10, 0.01 ).name( 'size' );
	// folder.add( uniforms.alpha, 'value', 0.0, 1, .001 ).name( 'alpha' );
	// folder.add( uniforms1.alpha, 'value', 0.0, 1, .001 ).name( 'alpha' );
	// folder.open();
	//
	// var lastTime = ( new Date() ).getTime();
	// var up = true;
	// function animate() {
	// 	//baseComponent.rotation.y+=0.01;
	// 	//water.rotation.x+=0.01;
	// 	water.geometry.verticesNeedUpdate = true;
	// 	requestAnimationFrame( animate );
	// 	// if(ms_Ocean.oceanMesh){
	// 	// 	if(up){
	// 	// 		for(var i = 0; i < ms_Ocean.oceanMesh.geometry.vertices.length; ++i){
	// 	// 			ms_Ocean.oceanMesh.geometry.vertices[i].y += 0.2;
	// 	// 		}
	// 	// 		if(ms_Ocean.oceanMesh.geometry.vertices[0].y > -60.0){
	// 	// 			up = false;
	// 	// 		}
	// 	// 	} else {
	// 	// 		for(var i = 0; i < ms_Ocean.oceanMesh.geometry.vertices.length; ++i){
	// 	// 			ms_Ocean.oceanMesh.geometry.vertices[i].y -= 0.2;
	// 	// 		}
	// 	// 		if(ms_Ocean.oceanMesh.geometry.vertices[0].y < -90.0){
	// 	// 			up = true;
	// 	// 		}
	// 	// 	}
	// 	//
	// 	//
	// 	// }
	// 	// ms_Ocean.oceanMesh.geometry.verticesNeedUpdate = true;
	// 	// var currentTime = new Date().getTime();
	// 	// ms_Ocean.deltaTime = ( currentTime - lastTime ) / 1000 || 0.0;
	// 	// lastTime = currentTime;
	// 	// ms_Ocean.render( ms_Ocean.deltaTime );
	// 	// ms_Ocean.overrideMaterial = ms_Ocean.materialOcean;
	// 	//
	// 	// if ( ms_Ocean.changed ) {
	// 	//
	// 	// 	ms_Ocean.materialOcean.uniforms[ "u_size" ].value = ms_Ocean.size;
	// 	// 	ms_Ocean.materialOcean.uniforms[ "u_sunDirection" ].value.set( ms_Ocean.sunDirectionX, ms_Ocean.sunDirectionY, ms_Ocean.sunDirectionZ );
	// 	// 	ms_Ocean.materialOcean.uniforms[ "u_exposure" ].value = ms_Ocean.exposure;
	// 	// 	ms_Ocean.changed = false;
	// 	//
	// 	// }
	// 	//
	// 	// ms_Ocean.materialOcean.uniforms[ "u_normalMap" ].value = ms_Ocean.normalMapFramebuffer.texture;
	// 	// ms_Ocean.materialOcean.uniforms[ "u_displacementMap" ].value = ms_Ocean.displacementMapFramebuffer.texture;
	// 	// ms_Ocean.materialOcean.uniforms[ "u_projectionMatrix" ].value = camera.projectionMatrix;
	// 	// ms_Ocean.materialOcean.uniforms[ "u_viewMatrix" ].value = camera.matrixWorldInverse;
	// 	// ms_Ocean.materialOcean.uniforms[ "u_cameraPosition" ].value = camera.position;
	// 	// ms_Ocean.materialOcean.depthTest = true;
	// 	var time = performance.now() * 0.001;
	//
	// 	// mesh.position.y = Math.sin( time ) * 20 + 5;
	// 	// mesh.rotation.x = time * 0.5;
	// 	// mesh.rotation.z = time * 0.51;
	//
	// 	water.material.uniforms[ 'time' ].value += 1.0 / 60.0;
	// 	water2.material.uniforms[ 'time' ].value += 1.0 / 60.0;
	// 	renderer.render( scene, camera );
	//
	//
	//
	// };
	// function setWaterMark(watermark) {
	// 	console.log(watermark,water.geometry);
	// 	for(var i = 0; i < water.geometry.vertices.length; ++i){
	// 		water.geometry.vertices[i].y += watermark;
	// 	}
	// }
	//
	// setWaterMark(3);
	//
	// animate();


</script>
</body>
</html>
