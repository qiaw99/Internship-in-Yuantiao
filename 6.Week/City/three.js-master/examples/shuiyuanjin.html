<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Vertices For Geometry</title>
    <script src="../build/three.js"></script>
    <script src="./js/libs/stats.js"></script>
    <script src="./js/utils/SceneUtils.js"></script>
    <script src="./js/shaders/CopyShader.js"></script>
	<script src="./js/loaders/GLTFLoader.js"></script>
	<script src="./js/misc/Gyroscope.js"></script>

</head>
<body>
<script id="vertex-Shader" type="x-shader/x-vertex">
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
		}
	</script>

<script id="fragment-Shader" type="x-shader/x-fragment">
		uniform sampler2D texture1;
		uniform sampler2D texture2;
		varying vec2 vUv;

		void main() {
			vec4 temp = texture2D(texture2,vUv);
			if(temp.x <0.1 && temp.y <0.1&&temp.x <0.1){
				gl_FragColor = vec4(1.0,1.0,1.0,0.0);
			} else {
			 	gl_FragColor = mix(temp*2.0, texture2D(texture1,vUv)*2.5, 0.5);
			}
		}
	</script>

<script id="fragment-Shader-tag" type="x-shader/x-fragment">
		uniform sampler2D texture1;
		uniform sampler2D texture2;
		varying vec2 vUv;

		void main() {
			vec4 temp = texture2D(texture2,vUv);
			gl_FragColor = mix(temp*2.0, texture2D(texture1,vUv)*2.5, 0.5);
		}
</script>

<script type="module">
    import { OrbitControls } from './jsm/controls/OrbitControls.js';
    import { GUI } from './jsm/libs/dat.gui.module.js';

	var mousePosition = new THREE.Vector2();
	mousePosition.x = -1e9;
	mousePosition.y = -1e9;
	var raycaster = new THREE.Raycaster();
	// raycaster.far = 1000000;
	// raycaster.near = 2000;
	var camera1 = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000000);//perspective是透视摄像机，这种摄像机看上去画面有3D效果
	camera1.position.set(1000,1000,1000);
	camera1.rotation.x = Math.PI;
	camera1.rotation.y = -Math.PI/4;
	camera1.rotation.z = Math.PI/2;
	camera1.lookAt(0, 0, 0);//摄像机对焦的位置
	var INTERSECTED = null;

	let lastCameraPos = new THREE.Vector3(-1,-1,-1);
	let interval = 15;

	export class Shuiyuanjin{

		constructor(modelUrl, widthModel, lengthModel, shuiyuanjinAlert,shuiyuanjinTagAlert,scaleSize, shuiyuanjinFunc){

			this.modelUrl = modelUrl;
			this.scaleSize = scaleSize;
			this.itemdis = 150;
			var textureLoader = new THREE.TextureLoader();
			this.shuiyuanjinAlertPic = textureLoader.load(shuiyuanjinAlert);
			this.shuiyuanjinTagAlertPic = textureLoader.load(shuiyuanjinTagAlert);
			this.previousAllstatus = true;
			this.currentAllStatus = true;

			this.speed = 0.002;
			this.widthModel = widthModel;
			this.lengthModel = lengthModel;

			this.fences_signal = [];
			this.interval = 30;
			this.return2Ori = false;

			this.allOffsets = {};

			this.allContents = {};
			this.allProperties = {};
			this.allDeleteLine = {};
			// this.allLinePosition = {};
			this.objects = new Set(); // 空Set

			this.label2value={};
			this.dis = 75;
			this.ddis = 150;

			this.v1 = new THREE.Vector3();

			this.shuiyuanjinFunc = shuiyuanjinFunc;
		}

		setUp(){
			this.scene = new THREE.Scene();
			this.canvas = [];
			this.canvas_ctx = [];

			for(var i = 0; i < 1; ++i){
				let canvas = document.createElement("canvas");
				canvas.width = 1024;
				canvas.height = 1024;
				this.canvas.push(canvas);
				let ctx = canvas.getContext('2d');

				this.canvas_ctx.push(ctx);
			}

			this.baseComponent = new THREE.Object3D();

			this.baseComponent.scale.set(this.scaleSize, this.scaleSize, this.scaleSize);
			// this.baseComponent.rotateOnAxis(new THREE.Vector3(1, 0,0), Math.PI / 2);
			// this.baseComponent.rotateOnAxis(new THREE.Vector3(0, 1,0), Math.PI / 2);

			var currentObj = this;
			this.renderer = new THREE.WebGLRenderer({
				antialias: true
			});//定义渲染器
			this.renderer.setSize(window.innerWidth, window.innerHeight);//设置渲染的宽度和高度
			this.renderer.setClearColor(0x000000, 1.0);//渲染的颜色设置
			document.body.appendChild(this.renderer.domElement);//将渲染器加在html中的div里面

			this.ms_Controls = new OrbitControls( camera1, this.renderer.domElement );
			// ms_Controls.userPan = false;
			// ms_Controls.userPanSpeed = 0.0;
			this.ms_Controls.minDistance = 1400;
			this.ms_Controls.maxDistance = 5000;
			this.ms_Controls.minPolarAngle = Math.PI/3.9;
			this.ms_Controls.maxPolarAngle = Math.PI/2.7;

			const gltfLoader = new THREE.GLTFLoader();

			gltfLoader.load(this.modelUrl, (gltf) => {
				const root = gltf.scene;

				root.children.forEach(element => {
					if(element.type == "Mesh" ){
						element.geometry.computeVertexNormals();
						element.geometry.center();
						element.material.emissive = element.material.color;
						element.material.emissiveMap = element.material.map;
						currentObj.baseComponent.add(element);
					}
				});



				//currentObj.scene.add( currentObj.baseComponent );
			});

			var that = this;
			const color = 0xaaaaaa;
			const intensity = 1.5;
			this.pointLight = new THREE.PointLight(color, intensity);

			this.pointLight.position.set(-0.2,0.0,0.11);
			this.pointLight.distance = 500;

			this.baseComponent.add(this.pointLight);

			this.redMaterial =new THREE.MeshBasicMaterial({color:0xff0000, side:THREE.DoubleSide});
			this.blueMaterial = new THREE.MeshBasicMaterial({color:0x276ed4, side:THREE.DoubleSide});
			this.fences = [];
			this.fences_times= [];
			this.fences_blue =[];
			for(var i = 0; i < 4; ++i){
				this.fences_blue.push(true);
				this.fences_signal.push(false);
				this.fences_times.push(0);
				let temp = new THREE.Object3D();
				let model;
				if(i < 2){
					model = this.widthModel;
				} else {
					model = this.lengthModel;
				}
				gltfLoader.load(model, function ( gltf ) {
					const root = gltf.scene;
					root.children.forEach(element => {
						if (element.type == "Mesh") {
							element.material = that.blueMaterial;
						}
					});
					var res = root.children[0];
					// res.rotation.y = -Math.PI;
					//res.rotation.y = -Math.PI;
					temp.add(res);
				} );
				this.fences.push(temp);
			}

			for(var i = 0 ; i <this.fences.length; ++i){
				this.baseComponent.add(this.fences[i]);
			}

			this.baseComponent.rotation.z = Math.PI;
			this.baseComponent.rotation.y = 1/5*Math.PI;
			this.fences[0].position.set(0,0,0);
			this.fences[1].position.set(-1.27,0,0);
			this.fences[2].position.set(0,0,0);
			this.fences[3].position.set(0,0,-0.8);



			var geo = new THREE.Geometry();
			geo.vertices = [new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0), new THREE.Vector3(1, 1, 0), new THREE.Vector3(1, 0, 0)];
			geo.faces = [new THREE.Face3(0, 1, 2), new THREE.Face3(0, 2, 3)];
			var faceuv = [new THREE.Vector2(0, 1), new THREE.Vector2(1, 1), new THREE.Vector2(1, 0), new THREE.Vector2(0, 0)];

			geo.faceVertexUvs[0] = [];
			geo.faceVertexUvs[0][0] = [faceuv[0], faceuv[1], faceuv[2]];
			geo.faceVertexUvs[0][1] = [faceuv[0], faceuv[2], faceuv[3]];

			this.alertTextures = [];

			for(var i = 0; i < 1; ++i){
				let alertCanvasTexture = new THREE.CanvasTexture(this.canvas[i]);
				this.alertTextures.push(alertCanvasTexture);
			}

			var shuiyuanjinAlertMixUniforms = {
				texture1 : {value : this.alertTextures[0]},
				texture2 : {value : this.shuiyuanjinAlertPic}
			};

			this.shuiyuanjinAlertPlanematerials = new THREE.ShaderMaterial({
				uniforms : shuiyuanjinAlertMixUniforms,
				vertexShader: document.getElementById( 'vertex-Shader' ).textContent,
				fragmentShader: document.getElementById( 'fragment-Shader' ).textContent,
				side: THREE.DoubleSide,
				transparent: true,
				alphaTest:0.1
			});

			this.shuiyuanjinAlert = new THREE.Mesh(geo, this.shuiyuanjinAlertPlanematerials);
			this.shuiyuanjinAlert.position.set(0.0,-0.7,-0.5);
			this.shuiyuanjinAlert.rotation.x = Math.PI/2;
			this.shuiyuanjinAlert.rotation.y = Math.PI/2
			this.shuiyuanjinAlert.rotation.z = Math.PI;
			this.shuiyuanjinAlert.scale.set(0.45,0.7,1);
			this.shuiyuanjinAlert.geometry.computeVertexNormals();
			this.shuiyuanjinAlert.geometry.center();
			this.baseComponent.add(this.shuiyuanjinAlert);


			this.shuiyuanjinPlanematerials = new THREE.MeshBasicMaterial({map:this.shuiyuanjinTagAlertPic, side:THREE.DoubleSide});

			this.shuiyuanjinTagAlert = new THREE.Mesh(geo, this.shuiyuanjinPlanematerials);
			this.shuiyuanjinTagAlert.geometry.computeVertexNormals();
			this.shuiyuanjinTagAlert.geometry.center();
			this.shuiyuanjinTagAlert.position.set(0,-0.15,0);
			this.shuiyuanjinTagAlert.scale.set(0.1,0.3,1);
			this.baseComponent.add(this.shuiyuanjinTagAlert);



			var cubeMat1 = new THREE.MeshBasicMaterial({//创建材料
				color:0x000000,
				// transparent:true,
				// opacity:0.0,
				// alphaTest:0.0
				// wireframe:true
			});
			this.wholeDetectObject = new THREE.Object3D();
			var cubeGeo2 = new THREE.CubeGeometry(1600,1200, 1200);//创建立方体
			this.wholeDetectCube = new THREE.Mesh(cubeGeo2, cubeMat1);//创建立方体网格模型
			this.wholeDetectObject.add(this.wholeDetectCube);
			this.wholeDetectObject.rotation.y=Math.PI/5;
			this.wholeDetectObject.position.set(0,-820,0);
			this.scene.add(this.wholeDetectObject);

			// var gui = new GUI();
			// var folder = gui.addFolder( 'Water' );
			// // //
			// // // folder.add(this.fences[1].position, 'x', this.fences[1].position.x-400, this.fences[1].position.x+400,0.1 ).name( 'p1' );
			// // // folder.add(this.fences[1].position, 'y', this.fences[1].position.y-200, this.fences[1].position.y+200, 0.5 ).name( 'p2' );
			// // // folder.add(this.fences[1].position, 'z', this.fences[1].position.z-400, this.fences[1].position.z+400, 0.1 ).name( 'p3' );
			// // // folder.add(this.fences[2].position, 'x', this.fences[2].position.x-400, this.fences[2].position.x+400,0.1 ).name( 'p1' );
			// // // folder.add(this.fences[2].position, 'y', this.fences[2].position.y-200, this.fences[2].position.y+200, 0.5 ).name( 'p2' );
			// // // folder.add(this.fences[2].position, 'z', this.fences[2].position.z-400, this.fences[2].position.z+400, 0.1 ).name( 'p3' );
			// folder.add(this.shuiyuanjinAlert.rotation, 'x', this.shuiyuanjinAlert.rotation.x-400, this.shuiyuanjinAlert.rotation.x+400,0.01 ).name( 'p1' );
			// folder.add(this.shuiyuanjinAlert.rotation, 'y', this.shuiyuanjinAlert.rotation.y-200, this.shuiyuanjinAlert.rotation.y+200, 0.01 ).name( 'p2' );
			// folder.add(this.shuiyuanjinAlert.rotation, 'z', this.shuiyuanjinAlert.rotation.z-400, this.shuiyuanjinAlert.rotation.z+400, 0.01 ).name( 'p3' );
			// //
			// folder.open();
			this.closeAll();
			this.scene.add(this.baseComponent);

			// this.detectMesh = [];
			// for(var i = 0; i < this.baseComponent.children.length; ++i){
			// 	if(this.baseComponent.children[i].type=="Mesh"){
			// 		this.detectMesh.push(this.baseComponent.children[i]);
			// 	}
			// }
			return this.baseComponent;
		}

		setPosition(position){
			this.position = position;
			this.baseComponent.position.set(this.position.x, this.position.y, this.position.z);
		}

		setScaleSize(scaleSize){
			this.scaleSize = scaleSize;
			this.baseComponent.scale.set(this.scaleSize , this.scaleSize , this.scaleSize );
		}
		setSpeed(speed){
			this.speed = speed;
		}
		turnOnFence(index){
			this.fences_signal[index-1]=true;
		}
		turnoffFence(index){
			this.fences_signal[index-1]=false;
		}
		animate(){
			if(this.baseComponent){

				if(this.speed==0.0 && lastCameraPos.x == camera1.position.x && lastCameraPos.y == camera1.position.y && lastCameraPos.z == camera1.position.z){
					interval--;
					if(interval == 0){
						this.showAll();
					}
				} else {
					interval = 15;
					lastCameraPos.x = camera1.position.x;
					lastCameraPos.y = camera1.position.y;
					lastCameraPos.z = camera1.position.z;
					this.closeAll();
				}

				camera1.getWorldPosition(this.v1)

				this.shuiyuanjinAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.shuiyuanjinAlert.rotation.z+=Math.PI*3/2;

				this.shuiyuanjinTagAlert.lookAt(this.v1.x,this.v1.y, this.v1.z);
				this.shuiyuanjinTagAlert.rotation.z+=Math.PI*3/2;

				this.renderContent();
				for(var i = 0; i < this.alertTextures.length; ++i){
					this.alertTextures[i].needsUpdate = true;
				}

				this.renderer.render(this.scene, camera1);
				// if(this.return2Ori){
				// 	if(this.direct == -1){
				// 		if(this.baseComponent.rotation.y>this.target){
				// 			this.baseComponent.rotation.y-=this.speed;
				// 		}
				// 		if(this.baseComponent.rotation.y <= this.target){
				// 			this.baseComponent.rotation.y=this.target;
				// 			this.return2Ori = false;
				// 			this.setSpeed(0.0);
				// 			this.showAll();
				// 		}
				// 	} else {
				// 		if(this.baseComponent.rotation.y<this.target){
				// 			this.baseComponent.rotation.y+=this.speed;
				// 		}
				// 		if(this.baseComponent.rotation.y >= this.target){
				// 			this.baseComponent.rotation.y=this.target;
				// 			this.return2Ori = false;
				// 			this.setSpeed(0.0);
				// 			this.showAll();
				// 		}
				// 	}
				// } else {
					raycaster.setFromCamera( mousePosition, camera1 );
					// console.log(this.detectMesh);
					//console.log(this.baseComponent.children[1],this.baseComponent.children[2],this.baseComponent.children[3],this.baseComponent.children[4]);
					var intersects = raycaster.intersectObjects([this.shuiyuanjinAlert, this.wholeDetectObject.children[0]] );

					// console.log(intersects);
					if((intersects.length != 0 && intersects[0].object == this.shuiyuanjinAlert) || intersects.length == 2){
						if(this.speed!=0.0){
							this.lastSpeed = this.speed;
							this.setSpeed(0.0);
							this.showAll();
						}
						this.shuiyuanjinFunc();
					} else if(intersects.length == 1){
						if(this.speed!=0.0){
							this.showAll();
							this.lastSpeed = this.speed;
							this.speed = 0.0;

							// this.setSpeed(0.02);
							//
							// if (this.baseComponent.rotation.y*1e15-(Math.PI*1/5)*1e15!=0) {
							// 	// debugger;
							// 	var round = Math.floor((this.baseComponent.rotation.y - (Math.PI * 1 / 5)) / (2 * Math.PI));
							// 	if (Math.abs(this.baseComponent.rotation.y - (Math.PI * 1 / 5 + round * 2 * Math.PI)) >
							// 			Math.abs(this.baseComponent.rotation.y - (Math.PI * 1 / 5 + (round + 1) * 2 * Math.PI))) {
							// 		this.target = Math.PI * 1 / 5 + (round + 1) * 2 * Math.PI;
							// 		this.direct = 1;
							// 	} else {
							// 		this.target = Math.PI * 1 / 5 + (round) * 2 * Math.PI;
							// 		this.direct = -1;
							// 	}
							// }
							// this.return2Ori = true;
						} else {
							this.closeAll();
							this.setSpeed(this.lastSpeed);
						}
					}

					mousePosition.x = -1e9;
					mousePosition.y = -1e9;
					this.baseComponent.rotation.y+=this.speed;
				// }
				for(var i = 0; i < this.fences_signal.length; ++i){
					if(this.fences_signal[i]){
						if(++this.fences_times[i] == this.interval){
							this.fences_times[i]=0;
							if(!this.fences_blue[i]) {
								this.fences[i].children[0].material = this.blueMaterial;
								this.fences_blue[i] = true;
							} else {
								this.fences[i].children[0].material = this.redMaterial;
								this.fences_blue[i] = false;
							}
						}

					}
				}

				if(this.previousAllstatus != this.currentAllStatus) {
					if(this.currentAllStatus){
						this.scene.add(this.baseComponent);
					} else {
						this.scene.remove(this.baseComponent);
					}
				}
			}
		}

		//大小,是否加粗,颜色
		setTitle(object,content, size, isBold, color){

			this.objects.add(object);
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			}
			if(this.allContents[object] == null){
				this.allContents[object] = [];
			}
			this.allContents[object].push(content);

			if(this.allProperties[object] == null){
				this.allProperties[object] = {};
			}

			var pro = [];
			pro.push(size*150);//大小
			pro.push(isBold);//是否加粗
			pro.push(color);//颜色
			this.allProperties[object][content] = pro;
		}

		setTitlePosition(object, offsetx, offsety){
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			} else {
				this.allOffsets[object][0] = offsetx*50;
				this.allOffsets[object][1] = offsety*50;
			}

		}

		deleteTitle(object){
			this.allDeleteLine[object][0] = true;
		}

		deleteWaterpoolAlert1Line(object, num){
			var cnt = 0;
			for(var i = 1; i < this.allContents[object].length-1; i+=2){
				let flag = true;
				if(this.allDeleteLine[object][i] == true){
					flag = false;
				}
				if(flag){
					cnt++;
					if(cnt == num){
						//console.log(i);
						this.allContents[object][i] = true;
						break;
					}
				}
			}
		}

		setDisBetwLabelValue(dis){
			this.dis = dis;
		}

		setDisBetwLabelLabel(ddis){
			this.ddis = ddis;
		}
		setLine(object, label, lsize, lisBold, lcolor, value, vsize, visBold, vcolor){
			if(this.allOffsets[object] == null){
				this.allOffsets[object] = [];
				this.allOffsets[object].push(0.0);
				this.allOffsets[object].push(0.0);
			}
			if(this.allContents[object] == null){
				this.allContents[object] = [];
			}
			if(this.label2value[object] == null){
				this.label2value[object] = {};
			}
			this.label2value[object][label] = value;

			this.allContents[object].push(label);

			if(this.allProperties[object] == null){
				this.allProperties[object] = {};
			}
			var pro = [];
			pro.push(lsize*150);
			pro.push(lisBold);
			pro.push(lcolor);
			this.allProperties[object][label] = pro;


			this.allContents[object].push(value);
			pro = [];
			pro.push(vsize*150);
			pro.push(visBold);
			pro.push(vcolor);
			this.allProperties[object][value] = pro;
		}
		changeLine(object, label, value, vsize, visBold, vcolor) {
			var pre =  this.label2value[object][label];
			this.label2value[object][label] = value;
			if(vsize!=null&&visBold!=null&&vcolor!=null){
				var pro = [];
				pro.push(vsize*150);
				pro.push(visBold);
				pro.push(vcolor);
				this.allProperties[object][value] = pro;
			} else {
				this.allProperties[object][value] = this.allProperties[object][pre];
			}

		}

		renderContent(){

			for (var object of this.objects) { // 遍历Set
				var index = parseInt(object);
				this.canvas_ctx[index].fillStyle = 'rgba(0,0,0,0)';
				this.canvas[index].style = "border:none";
				// this.c2.lineWidth = 0.0;
				this.canvas_ctx[index].fillRect(0, 0, this.canvas[index].width, this.canvas[index].height); //c.beginPath();
				var offsetx = 0;
				var offsety = 0;
				//debugger;
				var cnt = 0;
				for(var i = 0; i < this.allContents[object].length-1;){
					if(this.allDeleteLine[object]&&this.allDeleteLine[object][i]){
						if(i == 0){
							i++;
						} else {
							i+=2;
						}
						continue;
					}
					var boldSize = "";
					if(this.allProperties[object][this.allContents[object][i]][1]){
						boldSize += "bold ";
					} else {
						boldSize += "normal ";
					}
					boldSize += this.allProperties[object][this.allContents[object][i]][0];
					boldSize += "px ";
					boldSize += "微软雅黑";

					this.canvas_ctx[index].font = boldSize;//粗细/大小/字体
					this.canvas_ctx[index].textAlign = "left";
					this.canvas_ctx[index].textBaseline = "middle";
					this.canvas_ctx[index].fillStyle = this.allProperties[object][this.allContents[object][i]][2];//颜色


					if( i == 0){
						this.canvas_ctx[index].fillText(this.allContents[object][i], this.allOffsets[object][0] , this.allOffsets[object][1]);
						i++;
						offsety+=this.ddis;
					} else {
						this.canvas_ctx[index].fillText(this.allContents[object][i], this.allOffsets[object][0]+offsetx , this.allOffsets[object][1]+offsety);

						boldSize = "";
						if(this.allProperties[object][this.allContents[object][i]][1]){
							boldSize += "bold ";
						} else {
							boldSize += "normal ";
						}
						boldSize += this.allProperties[object][this.allContents[object][i]][0];
						boldSize += "px ";
						boldSize += "Arial";

						this.canvas_ctx[index].font = boldSize;//  粗细/ 大小/ 字体
						this.canvas_ctx[index].textAlign = "left";
						this.canvas_ctx[index].textBaseline = "middle";
						this.canvas_ctx[index].fillStyle = this.allProperties[object][this.label2value[object][this.allContents[object][i]]][2];//颜色

						this.canvas_ctx[index].fillText(this.label2value[object][this.allContents[object][i]], this.allOffsets[object][0]+this.dis+ offsetx, this.allOffsets[object][1]+offsety);
						cnt=cnt+1;
						if(cnt%2==0&&cnt!=0){
							offsety += this.ddis;
							offsetx -= this.itemdis;
						} else {
							offsetx += this.itemdis;
						}
						i+=2;
					}

				}
			}
		}
		setDisBetwItemItem(itemdis){
			this.itemdis = itemdis;
		}
		turnONOFF(status){
			this.previousAllstatus = this.currentAllStatus;
			this.currentAllStatus = status;
		}

		closeAll(){
			this.baseComponent.remove(this.shuiyuanjinAlert);
			this.baseComponent.remove(this.shuiyuanjinTagAlert);
		}
		showAll(){
			this.baseComponent.add(this.shuiyuanjinAlert);
			this.baseComponent.add(this.shuiyuanjinTagAlert);
		}

		destroy() {
			if (this.baseComponent) {
				if (this.baseComponent.children[0] != undefined) {
					if (this.baseComponent.children[0].children[0] != undefined) {
						//console.log("移除");
						this.baseComponent.children[0].children[0].geometry.dispose();
						this.baseComponent.children[0].children[0].geometry = null;
						this.baseComponent.children[0].children[0].material.dispose();
						this.baseComponent.children[0].children[0].material = null;
						this.scene.remove(this.baseComponent);
						this.baseComponent = null;
					}
				}
			}
		}
	}

	function onDocumentMouseMove( event ) {

		event.preventDefault();
		mousePosition.x = ( event.clientX / window.innerWidth ) * 2 - 1;
		mousePosition.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
		//console.log(this.mousePosition.x , this.mousePosition.y);
	}
	/* 窗口变动触发 */
	function onWindowResize() {

		camera1.aspect = window.innerWidth / window.innerHeight;
		camera1.updateProjectionMatrix();
		//renderer.setSize(window.innerWidth, window.innerHeight);

	}


	window.addEventListener( 'dblclick', onDocumentMouseMove, false );
	window.addEventListener('resize', onWindowResize, false);

	// let waveRadius = 20;
	// let waveHeight = 20;

	var shuiyuanjin = new Shuiyuanjin("./23.gltf","./syj_d.gltf","./syj_c.gltf", "./bg_tc11.png","syj.png",1000, function(){console.log("水源井视频");});

	let shuiyuanjinComponent = shuiyuanjin.setUp(); //初始化
	// shuiyuanjin.setUp();
	//
	shuiyuanjin.setTitle("0","123",0.25,true,"red");
	shuiyuanjin.setLine("0","12d3",0.25,true,"red","345",0.25,true,"red");
	shuiyuanjin.setLine("0","4564",0.25,true,"red","111",0.25,true,"red");

	shuiyuanjin.setLine("0","sadax",0.25,true,"red","354fa5",0.25,true,"red");
	shuiyuanjin.setLine("0","assdae",0.25,true,"red","sasd",0.25,true,"red");
	shuiyuanjin.setTitlePosition("0", 5,5);
	shuiyuanjin.changeLine("0","assdae","wwwwww",0.25,false,"blue");
	shuiyuanjin.turnOnFence(1);
	shuiyuanjin.setDisBetwLabelLabel(150);
	shuiyuanjin.setDisBetwLabelValue(150);
	shuiyuanjin.setDisBetwItemItem(350);
	function animate(){
		requestAnimationFrame(animate);
		shuiyuanjin.animate();
	}
	animate();





</script>
</body>
</html>
